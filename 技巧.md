# 查看、编辑二进制文件

先安装Hex Editor 插件

F1打开命令面版后输入Hex Editor

或者在左边文件树那里选择一个文件，鼠标右键 “Open With" 然后选择 Hex Editor 打开即可



# 代码截图

CodeSnap 插件安装成功后，在代码编辑页面点击鼠标右键，在弹出来的选项内就可以看到有 CodeSnap 选项。

![在这里插入图片描述](https://img-blog.csdnimg.cn/cffd216c7460445abd197df54aa55a89.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWUplcg==,size_20,color_FFFFFF,t_70,g_se,x_16)

选中你想要截图的代码，然后点击鼠标右键，在弹出的选项中选择 CodeSnap 选项，就会看到页面右边已经生成了代码截图的预览图。

![在这里插入图片描述](https://img-blog.csdnimg.cn/a22454d930fe41b8a9e5a1f4018c73e3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWUplcg==,size_20,color_FFFFFF,t_70,g_se,x_16)

如果你想保存这张截图到本地目录的话，点击一下代码截图上方的彩虹色圈圈，就会弹出对话框，让你选择截图保存的路径。

![在这里插入图片描述](https://img-blog.csdnimg.cn/d4c92d5bdcc94c00b2bad2e0f6a95f53.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWUplcg==,size_20,color_FFFFFF,t_70,g_se,x_16)

如果你并不想保存该截图，只是想将该截图复制粘贴到你的文章中，那么只需要点击一下截图，然后 Ctrl+C 即可完成复制，然后在你想粘贴代码截图的地方 Ctrl+V 即可。

复制到Typora默认路径: 

> C:\Users\zyy\AppData\Roaming\Typora\typora-user-images



# 位操作

## 把除了xxx的其他位置设置成0

```asm
; 把除了最后四位的其他位置设置成0
and al, 0x0f    ; 0x0f=1111, 
```



## 把x位设为0/1

```asm
; 把除了最后四位的其他位置设置成0
and al, 0x0f    ; 0x0f=1111, 
or al, 0xe0     ; 0xe0=1110 0000, 把第7-4位设置成1110 转换为LBA模式
```

```c
#define BITMAP_MASK 1

// vaule 为某位要置的数
if (value) {
	// 如果 vaule 为 1, 按位或
	btmp->bits[byte_idx] |= (BITMAP_MASK << bit_odd);
} else {
	// 如果 vaule 为 0, 取反再按位与
	btmp->bits[byte_idx] &= ~(BITMAP_MASK << bit_odd);
}

/* 将位图 btmp 的 bit_idx 位设置为 value */
void bitmap_set(struct bitmap* btmp, uint32_t bit_idx, int8_t value) {
    ASSERT((value == 0) || (value == 1));
    uint32_t byte_idx = bit_idx / 8;    // 向下取整用于索引数组下标
    uint32_t bit_odd = bit_idx % 8;     // 取余用于索引数组内的位

    if (value) {
        // 如果 vaule 为 1, 按位或
        btmp->bits[byte_idx] |= (BITMAP_MASK << bit_odd);
    } else {
        // 如果 vaule 为 0, 取反再按位与
        // 取反: 将除所要操作的位置 0, 其余位全部置 1
        // 按位与: 1 & 1 = 1, 0 & 1 = 0, 即其余位不受影响, 目标位置 0
        btmp->bits[byte_idx] &= ~(BITMAP_MASK << bit_odd);
    }
}
```



## 保留第x位

```asm
and al, 0x88    ; 0x88=1000 1000, 保留第3和第7位 ,第3位为1表示硬盘控制器已经准备好数据， 第7位为1表示硬盘很忙
```



# 整形强转指针

```c
int* ptr = (int*)  0x805000;	// ptr指向0x80500这块内存空间
printf("\nptr = %x\n", ptr);

printf("\n&ptr = %x\n", &ptr);
```

```
ptr = 805000

&ptr = 64fe00
```

![指针转换](E:\操作系统真象还原\note\picture\指针转换.png)

![指针转换2](E:\操作系统真象还原\note\picture\指针转换2.png)

